---
const currentYear = new Date().getFullYear();
import GalleryPreviewStrip from './GalleryPreviewStrip.astro';
import ShareDrawer from '@/components/ShareDrawer.jsx';

const { previewImages = [], previewPath = "", title = "" } = Astro.props;

// Get actual runtime URL
const currentPath = Astro.url.pathname;

// Check if we're on a deep image page like /i-xxxxx
const isImagePage = /\/i-[a-zA-Z0-9]+$/.test(currentPath);

// âœ… Only show strip if preview data exists AND we are NOT on an /i-xxxxx page
const showPreviewBar =
  previewImages.length > 0 &&
  previewPath &&
  !isImagePage;

// fallback share image if previewImages[0] is undefined
const shareImage = previewImages?.[0]?.src || undefined;
---

<footer
  class="bg-[#fff] font-serif text-center pb-16 w-full"
  style="font-family: 'Glegoo', serif;"
  aria-label="Site footer"
  itemscope
  itemtype="https://schema.org/Organization"
>

  {showPreviewBar && (
    <div class="w-full max-w-screen-xl mx-auto px-4 pb-2">
      <GalleryPreviewStrip
        images={previewImages}
        path={previewPath}
        limit={6}
      />
    </div>
  )}

  <div class="mx-auto max-w-xl px-4 pt-8 pb-4 footer-fade" aria-label="Footer controls and info">

    <!-- ðŸ”— Share Drawer (with fallback) -->
    <div class="pb-4">
      <ShareDrawer
        client:load
        imageUrl={shareImage}
        pageTitle={title}
      />
    </div>

    <!-- ðŸŒ Social Icons -->
    <div class="flex justify-center gap-5 mb-3">
      <a href="https://www.facebook.com/wayne.heim" target="_blank" rel="noopener noreferrer">
        <img class="social-icon" src="https://cdn.simpleicons.org/facebook/444444" alt="Facebook" width="20" height="20" itemprop="sameAs" />
      </a>
      <a href="https://www.instagram.com/wayneheim" target="_blank" rel="noopener noreferrer">
        <img class="social-icon" src="https://cdn.simpleicons.org/instagram/444444" alt="Instagram" width="20" height="20" itemprop="sameAs" />
      </a>
      <a href="https://www.threads.net/@wayneheim" target="_blank" rel="noopener noreferrer">
        <img class="social-icon" src="https://cdn.simpleicons.org/threads/444444" alt="Threads" width="20" height="20" itemprop="sameAs" />
      </a>
      <a href="https://www.pinterest.com/wayneheim" target="_blank" rel="noopener noreferrer">
        <img class="social-icon" src="https://cdn.simpleicons.org/pinterest/444444" alt="Pinterest" width="20" height="20" itemprop="sameAs" />
      </a>
      <a href="https://500px.com/wayneheim" target="_blank" rel="noopener noreferrer">
        <img class="social-icon" src="https://cdn.simpleicons.org/500px/444444" alt="500px" width="20" height="20" itemprop="sameAs" />
      </a>
      <a href="/Contact">
        <img class="social-icon" src="https://cdn.simpleicons.org/gmail/444444" alt="Email" width="20" height="20" itemprop="sameAs" />
      </a>
    </div>

    <!-- ðŸ„¯ Copyright -->
    <div class="text-xs text-[#2c2c2c] opacity-70" itemprop="name">
      <time datetime={currentYear} aria-label={`Copyright ${currentYear}`}>&copy; {currentYear}</time>
      {' '}Wayne Heim |{' '}
      <a href="/" rel="noopener noreferrer" class="underline hover:no-underline" title="Home">Home</a>
      {' '}<span class="opacity-50">|</span>{' '}
      <a href="/Glossary" class="underline hover:no-underline" title="Story Glossary">Story Glossary</a>
      {' '}| All rights reserved.
    </div>
  </div>

  <style>
    .footer-fade {
      opacity: 0.5;
      transition: opacity 0.4s cubic-bezier(.4,0,.2,1);
    }
    .footer-fade:hover,
    .footer-fade:focus-within {
      opacity: 1;
    }
    .social-icon {
      opacity: 0.32;
      transition: opacity 0.3s, transform 0.3s, filter 0.3s;
    }
    .social-icon:hover {
      opacity: 1;
      transform: scale(1.2);
      filter: sepia(1) hue-rotate(10deg) saturate(3) brightness(0.8);
    }
  </style>
</footer>
